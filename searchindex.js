Search.setIndex({"docnames": ["basic_example", "deel.torchlip", "deel.torchlip.functional", "deel.torchlip.init", "deel.torchlip.normalizers", "deel.torchlip.utils", "index", "wasserstein_classification_MNIST08", "wasserstein_classification_fashionMNIST", "wasserstein_toy", "wasserstein_toy_classification"], "filenames": ["basic_example.rst", "deel.torchlip.rst", "deel.torchlip.functional.rst", "deel.torchlip.init.rst", "deel.torchlip.normalizers.rst", "deel.torchlip.utils.rst", "index.rst", "wasserstein_classification_MNIST08.rst", "wasserstein_classification_fashionMNIST.rst", "wasserstein_toy.rst", "wasserstein_toy_classification.rst"], "titles": ["Example and usage", "deel.torchlip", "deel.torchlip.functional", "deel.torchlip.init", "deel.torchlip.normalizers module", "deel.torchlip.utils", "Welcome to <code class=\"docutils literal notranslate\"><span class=\"pre\">deel-torchlip</span></code> documentation!", "Example 3: HKR classifier on MNIST dataset", "Example 4: HKR multiclass and fooling", "Example 1: Wasserstein distance estimation", "Example 2: HKR classifier on toy dataset"], "terms": {"In": [0, 1, 6, 7, 8, 9, 10], "order": [0, 6, 7, 8, 10], "make": [0, 7, 8, 10], "thing": [0, 8], "simpl": [0, 8], "follow": [0, 1, 7, 8, 9], "rule": 0, "have": [0, 10], "been": [0, 10], "dure": [0, 5], "develop": [0, 1], "deel": [0, 7, 8, 9, 10], "torchlip": [0, 7, 8, 9, 10], "torch": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10], "nn": [0, 1, 3, 4, 5, 7, 8, 9], "packag": 0, "structur": 0, "when": [0, 1, 2, 3, 4, 5, 8, 10], "k": [0, 1, 2, 6, 7, 8], "lipschitz": [0, 1, 2, 3, 5, 6, 8, 10], "overrid": 0, "standard": [0, 8], "same": [0, 1, 2, 8], "interfac": 0, "paramet": [0, 1, 2, 3, 4, 5, 7, 8, 10], "The": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10], "onli": [0, 1, 7, 8, 9, 10], "differ": [0, 1, 2, 8], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "new": [0, 1, 7, 8, 10], "control": [0, 1, 6, 8], "constant": [0, 1, 6, 8], "layer": [0, 3, 4, 6, 7, 8, 9, 10], "from": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "mostli": 0, "wrapper": 0, "around": 0, "initi": [0, 1, 4, 6, 7, 8, 9], "normal": [0, 1, 3, 9, 10], "hook": [0, 1, 4], "ensur": [0, 1, 5, 10], "1": [0, 1, 2, 4, 5, 6], "properti": [0, 1, 8, 10], "For": [0, 1, 4, 7, 8], "instanc": [0, 7, 8], "spectrallinear": [0, 1, 7, 8, 9, 10], "simpli": [0, 9], "linear": [0, 5, 6, 7, 8, 9], "automat": [0, 8], "orthogon": [0, 3, 9], "thi": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10], "code": 0, "about": [0, 1, 7, 9], "equival": [0, 1, 2, 6, 8, 9, 10], "16": [0, 5, 8, 9], "32": [0, 7, 8, 9], "m": [0, 1, 2, 5, 8, 9, 10], "init": [0, 1, 9, 10], "orthogonal_": [0, 3, 9], "weight": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10], "bia": [0, 1, 5, 7, 8, 9, 10], "data": [0, 1, 9, 10], "fill_": 0, "0": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "util": [0, 1, 4, 7, 8, 10], "spectral_norm": [0, 1, 3, 4, 5], "3": [0, 5], "bjorck_norm": [0, 1, 3, 4, 5], "15": [0, 3, 4, 7, 8], "tabl": 0, "indic": [0, 3, 8], "network": [0, 1, 2, 3, 6, 8, 10], "comment": 0, "frobeniuslinear": [0, 1, 7, 8, 9, 10], "similar": [0, 3, 8, 9], "singl": [0, 1, 9, 10], "output": [0, 1, 2, 7, 8, 9], "conv2d": [0, 1, 5, 6, 7, 8], "spectralconv2d": [0, 1, 7, 8], "frobeniusconv2d": [0, 1], "also": [0, 1, 3, 6, 7, 8, 9, 10], "implement": [0, 1, 5, 6, 8], "bj\u00f6rck": 0, "maxpool": 0, "globalmaxpool": 0, "ye": 0, "n": [0, 1, 2, 4], "avgpool2d": [0, 6], "adaptiveavgpool2d": [0, 1], "scaledavgpool2d": [0, 1], "scaledadaptiveavgpool2d": [0, 1], "scaledl2normpool2d": [0, 1, 8], "scaledadaptativel2normpool2d": [0, 1], "bound": [0, 1, 8], "sqrt": [0, 5, 8], "pool_h": 0, "pool_w": 0, "flatten": [0, 7, 8, 9], "convtranspose2d": [0, 1], "spectralconvtranspose2d": [0, 1], "batchnorm1d": 0, "batchnorm2d": 0, "batchnorm3d": 0, "batchcent": 0, "appli": [0, 1, 2, 3, 4, 5, 8], "base": [0, 1, 10], "statist": 0, "batch": [0, 1, 2, 7, 8, 9], "factor": [0, 1, 2, 8, 10], "layernorm": 0, "layercent": 0, "each": [0, 1, 4, 7, 8, 9, 10], "sampl": [0, 1, 7, 8, 10], "residu": 0, "connect": [0, 1, 7], "lipresidu": 0, "learn": [0, 1], "mix": 0, "branch": 0, "dropout": 0, "none": [0, 1, 2, 4, 8, 9], "here": [0, 7, 8], "show": [0, 8, 10], "build": [0, 8, 10], "import": [0, 7, 8, 9, 10], "devic": [0, 1, 7, 8, 9, 10], "cuda": [0, 7, 8, 9, 10], "is_avail": [0, 7, 8, 9, 10], "els": [0, 7, 8, 9, 10], "cpu": [0, 7, 8, 9, 10], "can": [0, 1, 2, 3, 6, 7, 8, 9, 10], "like": [0, 8], "ani": [0, 1, 8, 9], "sequenti": [0, 1, 7, 8, 9, 10], "other": [0, 1, 8, 9, 10], "type": [0, 1, 9], "contain": [0, 2, 3, 4, 5, 8, 9], "model": [0, 1], "pad": [0, 1, 8], "maxpool2d": 0, "kernel_s": [0, 1, 5, 8], "2": [0, 1, 2, 3, 5], "1568": [0, 8], "256": [0, 9, 10], "train": [0, 3, 5, 7, 10], "done": [0, 1, 7, 8, 10], "usual": [0, 8, 10], "except": 0, "we": [0, 3, 7, 8, 9, 10], "do": [0, 10], "binari": [0, 1, 7, 10], "classif": [0, 1, 2, 5, 6, 8], "label": [0, 1, 2, 7, 8, 9, 10], "target": [0, 1, 2, 7, 8, 9, 10], "must": [0, 1, 4, 5, 7, 8], "fix": 0, "dataset": [0, 8, 9], "optim": [0, 1, 5, 6, 7, 8, 9], "adam": [0, 7, 8, 9, 10], "lr": [0, 7, 8, 9, 10], "01": [0, 9, 10], "param": [0, 7, 8, 9, 10], "mnist_08": 0, "zero_grad": [0, 7, 8, 9, 10], "loss": [0, 6, 7], "function": [0, 3, 4, 5, 6, 7, 8, 9, 10], "hkr_loss": [0, 1, 2, 7, 8, 10], "alpha": [0, 1, 2, 7, 8, 10], "10": [0, 3, 4, 7, 8, 9, 10], "min_margin": [0, 1, 2, 7, 8, 10], "backward": [0, 7, 8, 9, 10], "step": [0, 1, 7, 8, 9, 10], "see": [0, 1, 3, 5, 7, 8, 9, 10], "complet": [0, 3, 4], "api": [0, 8], "descript": 0, "bjorck": [1, 3, 4, 9], "remove_bjorck_norm": [1, 5], "frobeniu": [1, 9, 10], "frobenius_norm": [1, 5], "remove_frobenius_norm": [1, 5], "l": [1, 4, 9], "conv": 1, "lconv_norm": [1, 5], "remove_lconv_norm": [1, 5], "sqrt_with_gradep": [1, 5], "max_min": 1, "group_sort": 1, "group_sort_2": [1, 2], "full_sort": [1, 2], "lipschitz_prelu": [1, 2], "kr_loss": [1, 2, 7, 9, 10], "neg_kr_loss": [1, 2], "hinge_margin_loss": [1, 2, 7, 10], "multiclass": 1, "hinge_multiclass_loss": [1, 2], "hkr_multiclass_loss": [1, 2], "bjorck_": [1, 3], "spectral_": [1, 3], "modul": [1, 5, 10], "class": [1, 7, 8, 9, 10], "lipschitzmodul": 1, "coefficient_lip": 1, "float": [1, 2, 3, 4, 5, 7, 8, 9, 10], "sourc": [1, 2, 3, 4, 5], "allow": [1, 8, 9, 10], "set": [1, 2, 4, 7, 8, 9, 10], "inherit": 1, "user": 1, "regroup": 1, "us": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10], "But": 1, "doe": 1, "mean": [1, 7, 8, 9, 10], "won": 1, "t": [1, 4, 7, 8], "anyth": 1, "apply_lipschitz_factor": 1, "multipli": [1, 5], "abstract": 1, "vanilla_export": [1, 7, 8, 10], "convert": [1, 7, 8], "correspond": [1, 2, 4], "vanilla": 1, "possibl": [1, 2], "return": [1, 2, 4, 5, 7, 9], "A": [1, 2, 3, 5, 8], "version": [1, 2, 7, 10], "arg": [1, 9], "k_coef_lip": [1, 2, 8], "lip": [1, 6, 9], "global": [1, 10], "support": [1, 6], "condens": [1, 8], "export": [1, 10], "now": [1, 9, 10], "repartit": 1, "get": [1, 10], "n_sqrt": 1, "k_lip_factor": 1, "where": [1, 2, 4, 9, 10], "number": [1, 3, 4, 5, 9, 10], "futur": 1, "mai": 1, "list": [1, 7, 10], "add": [1, 5, 10], "name": [1, 5], "coeffici": 1, "in_channel": [1, 8], "int": [1, 2, 3, 4, 7, 9], "out_channel": [1, 8], "tupl": [1, 4, 9], "stride": [1, 5, 8], "dilat": 1, "group": 1, "bool": [1, 2, 5], "true": [1, 2, 5, 7, 8, 9, 10], "padding_mod": 1, "str": [1, 5, 9], "zero": [1, 9], "eps_spectr": [1, 3], "001": [1, 3, 4, 5, 7], "eps_bjorck": [1, 3], "constrain": 1, "all": [1, 4, 5, 7, 8, 9, 10], "singular": [1, 4, 9, 10], "": [1, 7, 9, 10], "kernel": [1, 4, 5], "ar": [1, 2, 3, 7, 8, 9, 10], "comput": [1, 2, 4, 5, 7, 8, 9, 10], "bjorcknorm": 1, "algorithm": [1, 3, 4], "As": [1, 7, 9, 10], "enough": 1, "coerciv": 1, "three": 1, "reduc": [1, 5], "largest": [1, 2, 4], "valu": [1, 2, 3, 4, 5, 8, 9, 10], "iter": [1, 3, 4, 5, 7, 8], "power": [1, 3], "method": [1, 3, 7, 8, 10], "increas": [1, 8], "divid": [1, 9], "channel": [1, 4], "input": [1, 2, 5, 7], "imag": [1, 2, 8], "produc": 1, "size": [1, 2, 7, 9], "convolv": 1, "option": [1, 4, 8], "ad": 1, "both": 1, "side": 1, "string": 1, "reflect": 1, "replic": 1, "circular": 1, "default": [1, 4], "space": [1, 9, 10], "between": [1, 2, 8, 9, 10], "element": [1, 8, 10], "ha": [1, 6, 8, 9, 10], "one": [1, 2, 5, 7, 8, 9, 10], "block": 1, "If": [1, 2, 4, 5], "learnabl": 1, "stop": [1, 3, 4], "criterion": [1, 3, 4], "document": 1, "reus": 1, "bodi": [1, 8], "origin": [1, 5, 8], "doc": 1, "case": [1, 2, 8, 9, 10], "addit": 1, "mode": [1, 7, 8], "symmetr": 1, "output_pad": 1, "dtype": [1, 7], "2d": [1, 5], "transpos": [1, 8], "oper": [1, 9], "over": [1, 9, 10], "an": [1, 8, 9, 10], "intern": [1, 2, 4], "state": [1, 7, 9, 10], "share": 1, "scriptmodul": 1, "output_s": 1, "adapt": 1, "max": [1, 2, 7, 8, 10], "signal": 1, "compos": 1, "sever": 1, "plane": 1, "h": 1, "x": [1, 2, 5, 7, 8, 9, 10], "w": [1, 2, 4, 5, 7, 9], "featur": [1, 8], "equal": [1, 4, 5, 8, 9, 10], "form": 1, "squar": [1, 5, 8, 9], "either": 1, "which": [1, 7, 8, 9, 10], "scale": [1, 8, 10], "ceil_mod": [1, 8], "fals": [1, 2, 7, 8, 10], "count_include_pad": 1, "divisor_overrid": 1, "averag": [1, 8], "spatial": [1, 7], "window": 1, "implicit": 1, "ceil": 1, "instead": [1, 3, 4, 10], "floor": 1, "shape": [1, 2, 4, 5, 7, 8, 9, 10], "includ": 1, "calcul": 1, "specifi": 1, "divisor": 1, "otherwis": [1, 2], "averagepooling2d": 1, "norm": [1, 4, 7, 8, 9, 10], "preserv": [1, 8], "gradient": [1, 5, 8, 10], "almost": [1, 10], "everywher": [1, 10], "y": [1, 2, 7, 8, 10], "boureau": 1, "j": [1, 9], "ponc": 1, "et": [1, 2, 9], "lecun": 1, "theoret": 1, "analysi": 1, "visual": [1, 8, 10], "recognit": 1, "p": [1, 2, 7], "8": [1, 7, 8, 10], "aka": 1, "4d": 1, "tensor": [1, 2, 3, 4, 5, 7, 9, 10], "batch_siz": [1, 7, 8, 9, 10], "row": 1, "col": 1, "invertibledownsampl": 1, "invertibleupsampl": 1, "maxmin": [1, 10], "dim": [1, 2, 7, 8], "min": [1, 2, 7, 10], "c": [1, 2, 4, 9], "describ": [1, 2], "text": [1, 2, 7, 8, 10], "out": [1, 2, 5, 9], "n_i": [1, 2], "c_": [1, 2], "2j": [1, 2], "c_j": [1, 2], "dimens": [1, 2, 5], "0th": [1, 2], "first": [1, 2, 7, 8, 9, 10], "its": [1, 2, 4, 8, 9, 10], "enforc": [1, 2, 10], "2c": [1, 2], "wa": 1, "2c_": 1, "blot": [1, 2], "cord": [1, 2], "thome": [1, 2], "neural": [1, 2, 3, 6, 9, 10], "2016": [1, 2], "ieee": [1, 2], "confer": [1, 2], "process": [1, 2, 8], "icip": [1, 2], "phoenix": [1, 2], "az": [1, 2], "usa": [1, 2], "3678": [1, 2], "3682": [1, 2], "groupsort": [1, 2, 10], "group_siz": [1, 2], "sort": [1, 5, 9], "work": [1, 4, 10], "reshap": [1, 5, 7, 10], "g": [1, 7, 8, 9], "data_format": 1, "channels_first": 1, "channels_last": 1, "exampl": [1, 5], "randn": 1, "4": [1, 9], "2805": 1, "0528": 1, "6478": 1, "5745": 1, "4075": 1, "0435": 1, "2408": 1, "2945": 1, "groupsort2": [1, 8, 10], "detail": 1, "fullsort": [1, 2, 7, 9, 10], "full": 1, "lprelu": [1, 2], "num_paramet": 1, "25": [1, 8], "wise": 1, "prelu": [1, 2], "constraint": [1, 10], "lipschitzprelu": 1, "begin": [1, 2, 4], "geq": [1, 2, 8], "end": [1, 2, 4], "although": 1, "take": [1, 8, 10], "legitim": 1, "two": [1, 2, 7, 8, 9], "in_featur": [1, 5, 7, 8, 9, 10], "out_featur": [1, 5, 7, 8, 9, 10], "larget": 1, "h_": 1, "_featur": 1, "last": [1, 9, 10], "disjoint_neuron": [1, 5, 8], "neuron": [1, 5, 8], "faster": 1, "than": [1, 4, 5, 8], "multi": [1, 2], "affect": 1, "behaviour": 1, "stack": [1, 8, 10], "independ": [1, 5], "matrix": [1, 3, 5, 7, 9], "per": [1, 2, 4, 5, 8], "krloss": [1, 7, 9, 10], "multi_gpu": [1, 2], "reduct": 1, "true_valu": 1, "estim": [1, 2, 6, 7, 10], "wasserstein": [1, 2, 6], "distanc": [1, 2, 6, 7, 8], "kantorovich": [1, 2, 8, 10], "rubinstein": [1, 2, 8, 10], "dualiti": [1, 2, 10], "formul": [1, 2], "w_1": [1, 9, 10], "mu": [1, 2, 9, 10], "nu": [1, 2, 9, 10], "sup_": [1, 9, 10], "f": [1, 2, 5, 7, 8, 9, 10], "lip_1": [1, 2, 9, 10], "omega": [1, 2, 9, 10], "underset": [1, 2, 9, 10], "textbf": [1, 9, 10], "sim": [1, 2, 9, 10], "mathbb": [1, 2, 9, 10], "e": [1, 2, 7, 8, 9, 10], "left": [1, 9, 10], "right": [1, 4, 9, 10], "stand": 1, "distribut": [1, 2, 4, 7, 9, 10], "rest": 1, "note": [1, 2, 10], "rank": 1, "multilabel": 1, "categori": 1, "accept": [1, 2], "pre": [1, 2], "process_labels_for_multi_gpu": [1, 2], "gpu": [1, 2], "tpu": [1, 2], "strategi": [1, 2], "requir": [1, 2, 5, 7, 8, 9, 10], "run": [1, 2, 8], "sum": [1, 7, 8, 10], "auto": 1, "depreci": 1, "negkrloss": 1, "neg": [1, 2, 9], "more": [1, 8, 9, 10], "hingemarginloss": [1, 7, 10], "hing": [1, 2, 5, 6, 7, 8], "margin": [1, 2, 9, 10], "minim": [1, 2, 10], "hkrloss": [1, 7, 10], "regular": [1, 2, 5, 6, 8, 10], "serruri": [1, 6], "mamalet": [1, 6], "al": 1, "achiev": [1, 5, 6, 8], "robust": [1, 5, 6, 10], "transport": [1, 5, 6], "2021": 1, "It": [1, 2, 5, 8, 10], "trade": 1, "off": [1, 8], "kr": [1, 2, 7, 8], "hkrmulticlassloss": [1, 8], "should": [1, 2, 7], "hot": [1, 2, 8], "encod": [1, 2, 8], "softhkrmulticlassloss": [1, 8], "9": [1, 7, 8, 10], "alpha_mean": 1, "99": [1, 8], "temperatur": [1, 8], "hkr": 1, "softmax": 1, "term": [1, 2, 7, 8, 10], "result": [1, 8, 10], "fel": 1, "On": 1, "explain": [1, 8, 10], "perspect": 1, "2024": 1, "geometr": 1, "higher": 1, "highest": 1, "y_true": 1, "logit": [1, 2], "taucrossentropyloss": 1, "tau": 1, "size_averag": 1, "ignore_index": 1, "100": [1, 7, 8], "label_smooth": 1, "crossentropyloss": 1, "argument": [1, 8], "taubcewithlogitsloss": 1, "pos_weight": 1, "bcewithlogitsloss": 1, "categoricalhingeloss": 1, "sligthli": 1, "pytorch": [1, 2, 6, 7, 8, 9], "multimarginloss": 1, "relu": [1, 10], "given": [2, 3, 4, 5, 8, 9], "arbitrari": [2, 5, 8], "depend": 2, "convolut": [2, 5, 7], "clamp": 2, "mathcal": [2, 8], "sup": 2, "limits_": 2, "mathbf": [2, 5], "specif": [2, 8], "sign": [2, 7, 10], "setup": [2, 7, 8, 10], "elementwis": 2, "commonli": 2, "found": [2, 8], "tensorflow": [2, 6], "maximis": 2, "consist": 2, "fashion": 2, "place": [3, 7, 8], "trail": 3, "_": [3, 7, 8, 9], "These": [3, 10], "provid": [3, 4, 6, 7, 8], "recommend": [3, 5], "your": 3, "maxiter_spectr": 3, "maxiter_bjorck": 3, "beta": [3, 4], "5": [3, 4, 7, 9], "obtain": [3, 8, 10], "proper": 3, "semi": 3, "dimension": [3, 10], "maximum": [3, 4, 9], "spectral": [3, 4, 9, 10], "variou": [4, 7], "so": [4, 10], "most": [4, 9, 10], "ep": [4, 5, 7], "maxit": 4, "arrai": 4, "w_0": 4, "w_": 4, "w_n": 4, "overlin": 4, "properli": 4, "greatest": 4, "eigen": [4, 5], "approxim": [4, 5, 9], "epsilon": [4, 5, 7, 8], "wt": 4, "less": 4, "interv": 4, "after": [4, 7, 9, 10], "u": [4, 7, 9, 10], "sinc": [4, 7, 10], "vector": [4, 5], "randomli": 4, "twice": 4, "much": [4, 8], "perform": [4, 7, 8], "default_eps_spectr": 4, "default_maxiter_spectr": 4, "befor": [4, 5, 7], "remain": [5, 9], "close": [5, 7, 8], "greater": [5, 8], "via": 5, "parametr": [5, 7, 8, 9, 10], "parameter": 5, "greatli": [5, 7], "n_iter": 5, "20": [5, 8, 10], "40": [5, 8], "remov": [5, 8], "reparameter": 5, "dfrac": 5, "vert": [5, 7, 9, 10], "everi": 5, "forward": [5, 7, 8], "call": 5, "conv1d": 5, "1e": [5, 7, 8], "06": 5, "root": [5, 8], "valid": [5, 6, 7, 8], "frac": [5, 7, 8, 9], "partial": 5, "posit": [5, 9], "whose": 5, "associ": 5, "autograd": 5, "sqrtepsgrad": 5, "whole": 6, "mani": 6, "applic": 6, "rang": [6, 7, 8, 9, 10], "adversari": 6, "lispchitz": [6, 8], "variant": 6, "activ": [6, 7, 9, 10], "compat": [6, 7], "you": 6, "directli": [6, 8], "pypi": 6, "pip": [6, 7, 8, 9, 10], "need": [6, 8, 9, 10], "7": [6, 7, 8, 9, 10], "built": 6, "present": 6, "misc": 6, "2006": 6, "06520": 6, "author": 6, "mathieu": 6, "franck": 6, "alberto": 6, "gonz\u00e1lez": 6, "sanz": 6, "thibaut": 6, "boissin": 6, "jean": 6, "michel": 6, "loub": 6, "eustasio": 6, "del": 6, "barrio": 6, "titl": [6, 8, 9], "year": 6, "2020": 6, "eprint": 6, "arxiv": [6, 9], "notebook": [7, 8, 9, 10], "demonstr": 7, "how": [7, 8, 10], "mnist0": 7, "instal": [7, 8, 9, 10], "librari": [7, 8, 9, 10], "uncom": [7, 8, 9, 10], "line": [7, 9], "below": [7, 8, 9, 10], "qqq": [7, 8, 9, 10], "task": [7, 10], "select": [7, 8], "chang": 7, "torchvis": [7, 8], "selected_class": 7, "def": [7, 8, 9], "prepare_data": 7, "class_a": 7, "class_b": 7, "suitabl": 7, "item": [7, 8], "mask": 7, "255": 7, "float32": 7, "28": [7, 8], "y_": 7, "zeros_lik": [7, 8], "tensordataset": [7, 10], "download": [7, 8], "test": [7, 8, 10], "displai": 7, "info": 7, "print": [7, 8, 9, 10], "len": [7, 8, 10], "proport": [7, 9], "numpi": [7, 8, 9, 10], "2f": [7, 8], "11774": 7, "50": [7, 8], "31": [7, 8], "1954": 7, "experi": [7, 10], "fulli": [7, 8, 9], "howev": [7, 8], "art": 7, "ninput": 7, "wass": [7, 9, 10], "128": [7, 9, 10], "64": [7, 8, 9, 10], "start_dim": [7, 8, 9], "end_dim": [7, 8, 9], "parametrizedspectrallinear": [7, 8, 9, 10], "784": 7, "moduledict": [7, 8, 9, 10], "parametrizationlist": [7, 8, 9, 10], "_spectralnorm": [7, 8, 9, 10], "_bjorcknorm": [7, 8, 9, 10], "6": [7, 8, 9], "parametrizedfrobeniuslinear": [7, 8, 9, 10], "_frobeniusnorm": [7, 8, 9, 10], "epoch": [7, 8, 9, 10], "98": [7, 10], "train_load": [7, 8], "dataload": [7, 8, 10], "shuffl": [7, 8, 10], "test_load": [7, 8], "m_kr": [7, 8, 10], "m_hm": [7, 10], "m_acc": [7, 8, 10], "enumer": [7, 8, 10], "metric": [7, 8, 9, 10], "current": [7, 8], "v": [7, 8, 9], "04f": [7, 8, 10], "acc": [7, 8], "eval": [7, 8], "testo": 7, "append": [7, 8], "detach": [7, 8, 10], "cat": [7, 8], "val_": [7, 8], "join": [7, 8], "0272": 7, "4492": 7, "9184": 7, "val_loss": [7, 8], "0367": 7, "val_kr": [7, 8], "3308": 7, "val_acc": [7, 8], "9939": 7, "0518": 7, "7784": 7, "9926": 7, "0574": 7, "3190": 7, "0782": 7, "6303": 7, "9938": 7, "0751": 7, "1403": 7, "0978": 7, "5607": 7, "9952": 7, "0927": 7, "9920": 7, "9933": 7, "0873": 7, "2546": 7, "9958": 7, "1037": 7, "5868": 7, "9944": 7, "1186": 7, "7066": 7, "9960": 7, "1081": 7, "9397": 7, "9913": 7, "1189": 7, "0129": 7, "9955": 7, "1161": 7, "1834": 7, "1281": 7, "2577": 7, "1151": 7, "3653": 7, "9923": 7, "1292": 7, "4227": 7, "9967": 7, "1216": 7, "5185": 7, "1375": 7, "5687": 7, "9965": 7, "1253": 7, "6100": 7, "x_2": 7, "x_1": 7, "quad": 7, "scipi": 7, "pdist": 7, "next": [7, 8, 9], "dist": 7, "uniform": 7, "y1": 7, "y2": 7, "1420": 7, "xd": 7, "yd": 7, "8841": 7, "float64": 7, "under": 7, "find": [7, 8], "better": 7, "made": [7, 8], "svd": 7, "check": [7, 8, 9, 10], "children": 7, "hasattr": 7, "9999998211860657": 7, "000001072883606": 7, "000012755393982": 7, "9999998807907104": 7, "0000001192092896": 7, "onc": [7, 8], "finish": [7, 8], "infer": [7, 8], "counterpart": [7, 8], "modifi": [7, 8], "while": [7, 8, 9], "keep": [7, 8], "refer": [7, 8], "wexport": 7, "your_function_to_build_the_model": [7, 8], "copi": [7, 8], "load_state_dict": [7, 8], "state_dict": [7, 8], "pamatr": [7, 8], "vanilla_model": [7, 8], "one_input": [7, 8], "veri": [7, 8], "configur": 8, "extend": 8, "go": [8, 10], "through": [8, 9], "design": 8, "final": 8, "guarante": 8, "foolbox": 8, "fashion_mnist": 8, "augment": 8, "transform": 8, "train_set": 8, "fashionmnist": 8, "totensor": 8, "test_set": 8, "would": 8, "practic": 8, "common": 8, "head": 8, "There": 8, "wai": 8, "reparametr": 8, "project": 8, "doesn": 8, "avail": 8, "niter_bjorck": 8, "trick": 8, "updat": 8, "without": [8, 9, 10], "break": 8, "graph": 8, "resourc": 8, "consumpt": 8, "act": 8, "superclass": 8, "pool": 8, "avg": 8, "our": [8, 9, 10], "interoper": 8, "exist": 8, "similarli": 8, "parametrizedspectralconv2d": 8, "_lconvnorm": 8, "norm_typ": 8, "decreas": 8, "improv": [8, 10], "cost": [8, 9, 10], "accuraci": [8, 10], "inform": 8, "paper": 8, "choos": 8, "good": [8, 10], "hurt": 8, "too": 8, "accur": 8, "999": 8, "propos": 8, "unconstrian": 8, "92": 8, "995": 8, "krmulticlassloss": 8, "give": [8, 9, 10], "proxi": 8, "loss_choic": 8, "assert": 8, "pleas": 8, "kr_multiclass_loss": 8, "one_hot": 8, "num_class": 8, "pass": 8, "argmax": 8, "test_output": 8, "test_target": 8, "0161": 8, "7948": 8, "8425": 8, "0234": 8, "8237": 8, "1728": 8, "0144": 8, "3253": 8, "0181": 8, "8474": 8, "4679": 8, "0040": 8, "8522": 8, "6386": 8, "0191": 8, "8214": 8, "7816": 8, "0046": 8, "8574": 8, "9427": 8, "0098": 8, "8596": 8, "0056": 8, "0000": [8, 10], "8605": 8, "1595": 8, "0079": 8, "8680": 8, "1441": 8, "0049": 8, "8642": 8, "2765": 8, "0063": 8, "8634": 8, "3429": 8, "0053": 8, "8670": 8, "3516": 8, "0051": 8, "8664": 8, "3691": 8, "0021": 8, "8708": 8, "4078": 8, "0031": 8, "8698": 8, "4568": 8, "0072": 8, "8731": 8, "4747": 8, "8688": 8, "5106": 8, "0009": 8, "8726": 8, "5210": 8, "0026": 8, "8685": 8, "5051": 8, "11": 8, "0028": 8, "8751": 8, "5462": 8, "0022": 8, "8730": 8, "5741": 8, "12": 8, "0035": 8, "5864": 8, "0025": 8, "8707": 8, "5648": 8, "13": 8, "0027": 8, "8764": 8, "5977": 8, "0019": 8, "8718": 8, "6368": 8, "14": [8, 10], "0047": 8, "8789": 8, "6347": 8, "0044": 8, "8539": 8, "6234": 8, "0189": 8, "8788": 8, "6543": 8, "0003": 8, "8723": 8, "5902": 8, "0142": 8, "8793": 8, "6534": 8, "0006": 8, "8673": 8, "6843": 8, "17": 8, "0018": 8, "8809": 8, "6729": 8, "0014": 8, "7061": 8, "18": 8, "0005": 8, "8805": 8, "6892": 8, "0002": 8, "8692": 8, "6683": 8, "19": 8, "8814": 8, "7032": 8, "8754": 8, "6909": 8, "0095": 8, "8827": 8, "7164": 8, "0001": 8, "7713": 8, "21": [8, 9], "0062": 8, "8815": 8, "7312": 8, "0008": 8, "8776": 8, "7397": 8, "22": 8, "0057": 8, "8834": 8, "7449": 8, "8638": 8, "7346": 8, "23": 8, "0109": 8, "8844": 8, "7543": 8, "0016": 8, "8781": 8, "7080": 8, "24": 8, "0091": 8, "7597": 8, "7509": 8, "0054": 8, "8839": 8, "7827": 8, "7414": 8, "26": 8, "0093": 8, "8865": 8, "0024": 8, "7571": 8, "27": 8, "8854": 8, "7891": 8, "0007": 8, "8671": 8, "8054": 8, "0045": 8, "8848": 8, "8087": 8, "8765": 8, "7992": 8, "29": [8, 10], "0050": 8, "8855": 8, "8126": 8, "8716": 8, "7960": 8, "30": [8, 9], "0090": 8, "8858": 8, "8186": 8, "0015": 8, "8727": 8, "7698": 8, "0086": 8, "8882": 8, "8209": 8, "0029": 8, "8752": 8, "8335": 8, "0064": 8, "8871": 8, "8258": 8, "0030": 8, "8820": 8, "8266": 8, "33": 8, "8410": 8, "8742": 8, "8252": 8, "34": 8, "0157": 8, "8873": 8, "8518": 8, "8736": 8, "7995": 8, "35": [8, 9], "8877": 8, "8418": 8, "8739": 8, "8467": 8, "36": 8, "0137": 8, "8552": 8, "0023": 8, "8778": 8, "8063": 8, "37": 8, "0103": 8, "8881": 8, "8597": 8, "8720": 8, "8331": 8, "38": 8, "0100": 8, "8897": 8, "8594": 8, "0033": 8, "8811": 8, "39": 8, "8887": 8, "8630": 8, "8801": 8, "8755": 8, "8902": 8, "8691": 8, "41": 8, "0085": [8, 10], "8753": 8, "8756": 8, "8190": 8, "42": 8, "0170": 8, "8892": 8, "8745": 8, "0034": 8, "8807": 8, "8524": 8, "43": 8, "8909": 8, "8388": 8, "44": 8, "8922": 8, "8824": 8, "8573": 8, "45": 8, "0065": 8, "8898": 8, "8861": 8, "8763": 8, "8508": 8, "46": 8, "8908": 8, "8799": 8, "0038": 8, "8808": 8, "8540": 8, "47": 8, "0141": 8, "8932": 8, "0037": 8, "8794": 8, "8714": 8, "48": 8, "0101": 8, "8912": 8, "8959": 8, "49": 8, "0111": 8, "8918": 8, "8859": 8, "9193": 8, "8933": 8, "9104": 8, "0041": 8, "8818": 8, "8705": 8, "lppool2d": 8, "smaller": 8, "np": [8, 9, 10], "sub_data": 8, "sub_target": 8, "drop": 8, "misclassifi": 8, "well_classified_mask": 8, "retriev": 8, "images_list": 8, "targets_list": 8, "th": 8, "label_mask": 8, "top": 8, "formula": 8, "_1": 8, "_2": 8, "l2": [8, 9], "defeat": 8, "radiu": 8, "lower": 8, "cell": 8, "ten": 8, "compar": 8, "l2carliniwagnerattack": 8, "kind": 8, "fb": 8, "topk": 8, "carlini": 8, "wagner": 8, "fmodel": 8, "pytorchmodel": 8, "binary_search_step": 8, "8000": 8, "adv": 8, "success": 8, "dist_to_adv": 8, "3f": 8, "309": 8, "864": 8, "65": 8, "397": 8, "56": 8, "527": 8, "81": 8, "105": 8, "188": 8, "82": 8, "053": 8, "450": 8, "62": 8, "488": 8, "91": 8, "161": 8, "69": 8, "look": [8, 10], "interest": 8, "predict": [8, 10], "dispar": 8, "among": 8, "effic": 8, "shirt": 8, "denot": 8, "regard": 8, "counterfactu": 8, "tell": 8, "inscript": 8, "turn": [8, 9, 10], "sens": 8, "non": 8, "reveal": 8, "reli": 8, "textur": 8, "rather": 8, "decis": 8, "matplotlib": [8, 9, 10], "pyplot": [8, 9, 10], "plt": [8, 9, 10], "adversarial_viz": 8, "class_nam": 8, "map": 8, "observ": 8, "nb_img": 8, "orig_class": 8, "advs_class": 8, "diff_po": 8, "clip": 8, "diff_neg": 8, "diff_map": 8, "concaten": [8, 9], "axi": [8, 9, 10], "creat": [8, 9], "plot": 8, "_set_ax": 8, "ax": [8, 9, 10], "set_titl": [8, 9], "set_xtick": [8, 9], "set_ytick": [8, 9], "figsiz": [8, 9, 10], "subplot": [8, 9, 10], "ncol": 8, "nrow": 8, "squeez": 8, "constrained_layout": 8, "imshow": [8, 9], "cmap": [8, 9, 10], "grai": [8, 9], "ob": 8, "represent": 9, "measur": [9, 10], "probabl": [9, 10], "wikipedia": [9, 10], "articl": [9, 10], "intuit": [9, 10], "definit": [9, 10], "view": [9, 10], "unit": [9, 10], "amount": [9, 10], "dirt": [9, 10], "pile": [9, 10], "minimum": [9, 10], "assum": [9, 10], "move": [9, 10], "time": [9, 10], "becaus": [9, 10], "analogi": [9, 10], "known": [9, 10], "scienc": [9, 10], "earth": [9, 10], "mover": [9, 10], "mathemat": [9, 10], "defin": [9, 10], "inf_": [9, 10], "pi": [9, 10], "z": [9, 10], "equat": [9, 10], "tractabl": [9, 10], "illustr": 9, "synthet": [9, 10], "black": 9, "white": 9, "correct": 9, "middl": 9, "center": [9, 10], "generate_toy_imag": 9, "gener": 9, "rectangl": 9, "assign": 9, "img": 9, "ldec": 9, "wdec": 9, "infinit": 9, "half": 9, "come": 9, "second": [9, 10], "fraction": 9, "yield": 9, "pwhite": 9, "nwhite": 9, "nblack": 9, "nsquar": 9, "npwhite": 9, "nnwhite": 9, "batch_x": 9, "repeat": 9, "batch_i": 9, "ones": 9, "display_imag": 9, "consid": 9, "64x64": 9, "inner": [9, 10], "cover": 9, "manual": 9, "img1": 9, "img2": 9, "img3": 9, "fig": [9, 10], "format": 9, "linalg": 9, "problem": [9, 10], "anil": 9, "luca": 9, "r": 9, "gross": 9, "1811": 9, "05381": 9, "nov": 9, "2018": 9, "section": 9, "short": 9, "http": 9, "github": 9, "com": 9, "ai": 9, "__": 9, "special": 9, "forc": 9, "converg": 9, "prod": 9, "4096": 9, "tqdm": 9, "trang": 9, "n_epoch": [9, 10], "steps_per_epoch": 9, "n_step": 9, "tstep": 9, "desc": 9, "set_postfix": 9, "6f": 9, "00": 9, "129946": 9, "02": 9, "98it": 9, "nan": 9, "kantorovitch": 10, "sklearn": 10, "make_moon": 10, "make_circl": 10, "circle_or_moon": 10, "circl": 10, "n_sampl": 10, "5000": 10, "nois": 10, "05": 10, "outer": 10, "advis": 10, "later": 10, "seaborn": 10, "sn": 10, "x1": 10, "x2": 10, "scatterplot": 10, "1000": 10, "solv": 10, "match": 10, "l_1": 10, "overal": 10, "deal": 10, "try": 10, "maxim": 10, "abov": 10, "account": 10, "actual": 10, "hand": 10, "To": 10, "want": 10, "alter": 10, "By": 10, "shown": 10, "still": 10, "admit": 10, "meaningful": 10, "solut": 10, "bj\u00f6rk": 10, "orthonorm": 10, "li": 10, "sub": 10, "respect": 10, "becom": 10, "readi": 10, "loader": 10, "0504": 10, "0614": 10, "1179": 10, "6261": 10, "0248": 10, "3622": 10, "0339": 10, "8957": 10, "4284": 10, "0083": 10, "9838": 10, "0110": 10, "5243": 10, "0010": 10, "0136": 10, "6442": 10, "9998": 10, "0124": 10, "7111": 10, "0011": 10, "0147": 10, "7326": 10, "9992": 10, "0146": 10, "7773": 10, "0013": 10, "7876": 10, "0158": 10, "7917": 10, "9994": 10, "pretti": 10, "draw": 10, "linspac": 10, "120": 10, "xx": 10, "yy": 10, "meshgrid": 10, "spars": 10, "x_pred": 10, "ravel": 10, "y_pred": 10, "vwass": 10, "y_predv": 10, "ax1": 10, "ax2": 10, "cset": 10, "contour": 10, "twilight": 10, "level": 10, "arang": 10, "clabel": 10, "inlin": 10, "fontsiz": 10, "object": 10, "overhead": 10}, "objects": {"deel.torchlip": [[1, 0, 1, "", "CategoricalHingeLoss"], [1, 0, 1, "", "FrobeniusConv2d"], [1, 0, 1, "", "FrobeniusLinear"], [1, 0, 1, "", "FullSort"], [1, 0, 1, "", "GroupSort"], [1, 0, 1, "", "GroupSort2"], [1, 0, 1, "", "HKRLoss"], [1, 0, 1, "", "HKRMulticlassLoss"], [1, 0, 1, "", "HingeMarginLoss"], [1, 0, 1, "", "InvertibleDownSampling"], [1, 0, 1, "", "InvertibleUpSampling"], [1, 0, 1, "", "KRLoss"], [1, 0, 1, "", "LPReLU"], [1, 0, 1, "", "LipschitzModule"], [1, 0, 1, "", "MaxMin"], [1, 0, 1, "", "NegKRLoss"], [1, 0, 1, "", "ScaledAdaptativeL2NormPool2d"], [1, 0, 1, "", "ScaledAdaptiveAvgPool2d"], [1, 0, 1, "", "ScaledAvgPool2d"], [1, 0, 1, "", "ScaledL2NormPool2d"], [1, 0, 1, "", "Sequential"], [1, 0, 1, "", "SoftHKRMulticlassLoss"], [1, 0, 1, "", "SpectralConv2d"], [1, 0, 1, "", "SpectralConvTranspose2d"], [1, 0, 1, "", "SpectralLinear"], [1, 0, 1, "", "TauBCEWithLogitsLoss"], [1, 0, 1, "", "TauCrossEntropyLoss"], [3, 3, 0, "-", "init"], [4, 3, 0, "-", "normalizers"]], "deel.torchlip.LipschitzModule": [[1, 1, 1, "", "apply_lipschitz_factor"], [1, 1, 1, "", "vanilla_export"]], "deel.torchlip.functional": [[2, 2, 1, "", "full_sort"], [2, 2, 1, "", "group_sort"], [2, 2, 1, "", "group_sort_2"], [2, 2, 1, "", "hinge_margin_loss"], [2, 2, 1, "", "hinge_multiclass_loss"], [2, 2, 1, "", "hkr_loss"], [2, 2, 1, "", "hkr_multiclass_loss"], [2, 2, 1, "", "kr_loss"], [2, 2, 1, "", "lipschitz_prelu"], [2, 2, 1, "", "max_min"], [2, 2, 1, "", "neg_kr_loss"]], "deel.torchlip.init": [[3, 2, 1, "", "bjorck_"], [3, 2, 1, "", "spectral_"]], "deel.torchlip.normalizers": [[4, 2, 1, "", "bjorck_normalization"], [4, 2, 1, "", "spectral_normalization"]], "deel.torchlip.utils": [[5, 2, 1, "", "bjorck_norm"], [5, 2, 1, "", "frobenius_norm"], [5, 2, 1, "", "lconv_norm"], [5, 2, 1, "", "remove_bjorck_norm"], [5, 2, 1, "", "remove_frobenius_norm"], [5, 2, 1, "", "remove_lconv_norm"], [5, 2, 1, "", "sqrt_with_gradeps"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:function", "3": "py:module"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "function", "Python function"], "3": ["py", "module", "Python module"]}, "titleterms": {"exampl": [0, 7, 8, 9, 10], "usag": 0, "which": 0, "modul": [0, 4], "ar": 0, "safe": 0, "us": 0, "how": 0, "deel": [1, 2, 3, 4, 5, 6], "torchlip": [1, 2, 3, 4, 5, 6], "contain": 1, "convolut": 1, "layer": 1, "pool": 1, "non": [1, 2], "linear": [1, 2], "activ": [1, 2], "loss": [1, 2, 8, 9, 10], "function": [1, 2], "max_min": 2, "group_sort": 2, "other": 2, "binari": 2, "multiclass": [2, 8], "init": 3, "initi": 3, "normal": [4, 5], "util": 5, "hook": 5, "bjorck": 5, "frobeniu": 5, "l": 5, "conv": 5, "welcom": 6, "document": 6, "content": 6, "librari": 6, "instal": 6, "cite": 6, "thi": 6, "work": 6, "3": [7, 8, 9, 10], "hkr": [7, 8, 10], "classifi": [7, 10], "mnist": 7, "dataset": [7, 10], "1": [7, 8, 9, 10], "data": [7, 8], "prepar": [7, 8], "2": [7, 8, 9, 10], "build": [7, 9], "lipschitz": [7, 9], "model": [7, 8, 9], "learn": [7, 10], "classif": [7, 10], "4": [7, 8, 10], "evalu": [7, 8], "constant": 7, "our": 7, "network": [7, 9], "empir": 7, "singular": 7, "valu": 7, "decomposit": 7, "export": [7, 8], "warn": 7, "fool": 8, "architectur": 8, "note": 8, "about": 8, "constraint": 8, "enforc": 8, "train": [8, 9], "5": [8, 10], "robust": 8, "certif": 8, "gener": 8, "adversari": 8, "attack": 8, "wasserstein": [9, 10], "distanc": [9, 10], "estim": 9, "paramet": 9, "input": 9, "imag": 9, "kantorovich": 9, "rubinstein": 9, "dual": [9, 10], "formul": [9, 10], "kr": [9, 10], "toi": 10, "two": 10, "moon": 10, "relat": 10, "optim": 10, "transport": 10, "hing": 10, "6": 10, "plot": 10, "output": 10, "countour": 10, "line": 10}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Example and usage": [[0, "example-and-usage"]], "Which modules are safe to use?": [[0, "which-modules-are-safe-to-use"]], "How to use it?": [[0, "how-to-use-it"]], "deel.torchlip": [[1, "deel-torchlip"]], "Containers": [[1, "containers"]], "Convolution Layers": [[1, "convolution-layers"]], "Pooling Layers": [[1, "pooling-layers"]], "Non-linear Activations": [[1, "non-linear-activations"]], "Linear Layers": [[1, "linear-layers"]], "Loss Functions": [[1, "loss-functions"]], "deel.torchlip.functional": [[2, "deel-torchlip-functional"]], "Non-linear activation functions": [[2, "non-linear-activation-functions"]], "max_min": [[2, "max-min"]], "group_sort": [[2, "group-sort"]], "others": [[2, "others"]], "Loss functions": [[2, "loss-functions"]], "Binary losses": [[2, "binary-losses"]], "multiclass losses": [[2, "multiclass-losses"]], "deel.torchlip.init": [[3, "deel-torchlip-init"]], "Initializers": [[3, "module-deel.torchlip.init"]], "deel.torchlip.normalizers module": [[4, "deel-torchlip-normalizers-module"]], "Normalizers": [[4, "module-deel.torchlip.normalizers"]], "deel.torchlip.utils": [[5, "deel-torchlip-utils"]], "Normalization hooks": [[5, "normalization-hooks"]], "Bjorck normalization": [[5, "bjorck-normalization"]], "Frobenius normalization": [[5, "frobenius-normalization"]], "L-Conv normalization": [[5, "l-conv-normalization"]], "Utilities": [[5, "utilities"]], "Welcome to deel-torchlip documentation!": [[6, "welcome-to-deel-torchlip-documentation"]], "Content of the library": [[6, "content-of-the-library"]], "Installation": [[6, "installation"]], "Cite this work": [[6, "cite-this-work"]], "Example 3: HKR classifier on MNIST dataset": [[7, "example-3-hkr-classifier-on-mnist-dataset"]], "1. Data preparation": [[7, "data-preparation"], [8, "data-preparation"]], "2. Build Lipschitz model": [[7, "build-lipschitz-model"]], "3. Learn classification on MNIST": [[7, "learn-classification-on-mnist"]], "4. Evaluate the Lipschitz constant of our networks": [[7, "evaluate-the-lipschitz-constant-of-our-networks"]], "4.1. Empirical evaluation": [[7, "empirical-evaluation"]], "4.1. Singular-Value Decomposition": [[7, "singular-value-decomposition"]], "4.2 Model export": [[7, "model-export"]], "Warnings:": [[7, "warnings"]], "Example 4: HKR multiclass and fooling": [[8, "example-4-hkr-multiclass-and-fooling"]], "2. Model architecture": [[8, "model-architecture"]], "Notes about constraint enforcement": [[8, "notes-about-constraint-enforcement"]], "3. HKR loss and training": [[8, "hkr-loss-and-training"]], "4. Model export": [[8, "model-export"]], "5. Robustness evaluation: certificate generation and adversarial attacks": [[8, "robustness-evaluation-certificate-generation-and-adversarial-attacks"]], "Example 1: Wasserstein distance estimation": [[9, "example-1-wasserstein-distance-estimation"]], "1. Wasserstein distance": [[9, "wasserstein-distance"]], "2. Parameters input images": [[9, "parameters-input-images"]], "3. Kantorovich-Rubinstein dual formulation": [[9, "kantorovich-rubinstein-dual-formulation"]], "3.1. Building a 1-Lipschitz model": [[9, "building-a-1-lipschitz-model"]], "3.2. Training a 1-Lipschitz network with KR loss": [[9, "training-a-1-lipschitz-network-with-kr-loss"]], "Example 2: HKR classifier on toy dataset": [[10, "example-2-hkr-classifier-on-toy-dataset"]], "1. Two moons dataset": [[10, "two-moons-dataset"]], "2. Relation with optimal transport": [[10, "relation-with-optimal-transport"]], "2.1. Wasserstein distance": [[10, "wasserstein-distance"]], "2.2. KR dual formulation": [[10, "kr-dual-formulation"]], "2.3. Hinge-KR loss": [[10, "hinge-kr-loss"]], "2.4. HKR classifier": [[10, "hkr-classifier"]], "2.5. Learn classification on toy dataset": [[10, "learn-classification-on-toy-dataset"]], "2.6. Plot output countour line": [[10, "plot-output-countour-line"]]}, "indexentries": {"categoricalhingeloss (class in deel.torchlip)": [[1, "deel.torchlip.CategoricalHingeLoss"]], "frobeniusconv2d (class in deel.torchlip)": [[1, "deel.torchlip.FrobeniusConv2d"]], "frobeniuslinear (class in deel.torchlip)": [[1, "deel.torchlip.FrobeniusLinear"]], "fullsort (class in deel.torchlip)": [[1, "deel.torchlip.FullSort"]], "groupsort (class in deel.torchlip)": [[1, "deel.torchlip.GroupSort"]], "groupsort2 (class in deel.torchlip)": [[1, "deel.torchlip.GroupSort2"]], "hkrloss (class in deel.torchlip)": [[1, "deel.torchlip.HKRLoss"]], "hkrmulticlassloss (class in deel.torchlip)": [[1, "deel.torchlip.HKRMulticlassLoss"]], "hingemarginloss (class in deel.torchlip)": [[1, "deel.torchlip.HingeMarginLoss"]], "invertibledownsampling (class in deel.torchlip)": [[1, "deel.torchlip.InvertibleDownSampling"]], "invertibleupsampling (class in deel.torchlip)": [[1, "deel.torchlip.InvertibleUpSampling"]], "krloss (class in deel.torchlip)": [[1, "deel.torchlip.KRLoss"]], "lprelu (class in deel.torchlip)": [[1, "deel.torchlip.LPReLU"]], "lipschitzmodule (class in deel.torchlip)": [[1, "deel.torchlip.LipschitzModule"]], "maxmin (class in deel.torchlip)": [[1, "deel.torchlip.MaxMin"]], "negkrloss (class in deel.torchlip)": [[1, "deel.torchlip.NegKRLoss"]], "scaledadaptativel2normpool2d (class in deel.torchlip)": [[1, "deel.torchlip.ScaledAdaptativeL2NormPool2d"]], "scaledadaptiveavgpool2d (class in deel.torchlip)": [[1, "deel.torchlip.ScaledAdaptiveAvgPool2d"]], "scaledavgpool2d (class in deel.torchlip)": [[1, "deel.torchlip.ScaledAvgPool2d"]], "scaledl2normpool2d (class in deel.torchlip)": [[1, "deel.torchlip.ScaledL2NormPool2d"]], "sequential (class in deel.torchlip)": [[1, "deel.torchlip.Sequential"]], "softhkrmulticlassloss (class in deel.torchlip)": [[1, "deel.torchlip.SoftHKRMulticlassLoss"]], "spectralconv2d (class in deel.torchlip)": [[1, "deel.torchlip.SpectralConv2d"]], "spectralconvtranspose2d (class in deel.torchlip)": [[1, "deel.torchlip.SpectralConvTranspose2d"]], "spectrallinear (class in deel.torchlip)": [[1, "deel.torchlip.SpectralLinear"]], "taubcewithlogitsloss (class in deel.torchlip)": [[1, "deel.torchlip.TauBCEWithLogitsLoss"]], "taucrossentropyloss (class in deel.torchlip)": [[1, "deel.torchlip.TauCrossEntropyLoss"]], "apply_lipschitz_factor() (deel.torchlip.lipschitzmodule method)": [[1, "deel.torchlip.LipschitzModule.apply_lipschitz_factor"]], "vanilla_export() (deel.torchlip.lipschitzmodule method)": [[1, "deel.torchlip.LipschitzModule.vanilla_export"]], "full_sort() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.full_sort"]], "group_sort() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.group_sort"]], "group_sort_2() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.group_sort_2"]], "hinge_margin_loss() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.hinge_margin_loss"]], "hinge_multiclass_loss() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.hinge_multiclass_loss"]], "hkr_loss() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.hkr_loss"]], "hkr_multiclass_loss() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.hkr_multiclass_loss"]], "kr_loss() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.kr_loss"]], "lipschitz_prelu() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.lipschitz_prelu"]], "max_min() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.max_min"]], "neg_kr_loss() (in module deel.torchlip.functional)": [[2, "deel.torchlip.functional.neg_kr_loss"]], "bjorck_() (in module deel.torchlip.init)": [[3, "deel.torchlip.init.bjorck_"]], "deel.torchlip.init": [[3, "module-deel.torchlip.init"]], "module": [[3, "module-deel.torchlip.init"], [4, "module-deel.torchlip.normalizers"]], "spectral_() (in module deel.torchlip.init)": [[3, "deel.torchlip.init.spectral_"]], "bjorck_normalization() (in module deel.torchlip.normalizers)": [[4, "deel.torchlip.normalizers.bjorck_normalization"]], "deel.torchlip.normalizers": [[4, "module-deel.torchlip.normalizers"]], "spectral_normalization() (in module deel.torchlip.normalizers)": [[4, "deel.torchlip.normalizers.spectral_normalization"]], "bjorck_norm() (in module deel.torchlip.utils)": [[5, "deel.torchlip.utils.bjorck_norm"]], "frobenius_norm() (in module deel.torchlip.utils)": [[5, "deel.torchlip.utils.frobenius_norm"]], "lconv_norm() (in module deel.torchlip.utils)": [[5, "deel.torchlip.utils.lconv_norm"]], "remove_bjorck_norm() (in module deel.torchlip.utils)": [[5, "deel.torchlip.utils.remove_bjorck_norm"]], "remove_frobenius_norm() (in module deel.torchlip.utils)": [[5, "deel.torchlip.utils.remove_frobenius_norm"]], "remove_lconv_norm() (in module deel.torchlip.utils)": [[5, "deel.torchlip.utils.remove_lconv_norm"]], "sqrt_with_gradeps() (in module deel.torchlip.utils)": [[5, "deel.torchlip.utils.sqrt_with_gradeps"]]}})